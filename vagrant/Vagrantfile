# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  # Base box to use for all VMs
  config.vm.box = "rockylinux/10"

  # Common settings applied to all VMs
  config.vm.provider "virtualbox" do |vb|
    vb.cpus = 2
    vb.memory = 2048
  end

  # Define a helper function for creating VMs
  def create_vm(config, name, hostname, ip)
    config.vm.define name do |node|
      # Set VM hostname
      node.vm.hostname = hostname

      # Second network interface (host-only)
      node.vm.network "private_network", ip: ip

      # Assign each VM to the same VirtualBox group
      node.vm.provider "virtualbox" do |vb|
        vb.name = name
        vb.customize ["modifyvm", :id, "--groups", "/WarehousePg"]
      end
    end
  end

  # Create the VMs
  create_vm(config, "compiler", "compiler.my.domain", "192.168.56.99")
  create_vm(config, "masterdb", "masterdb.my.domain", "192.168.56.70")
  create_vm(config, "sdw1", "sdw1.my.domain", "192.168.56.71")
  create_vm(config, "sdw2", "sdw2.my.domain", "192.168.56.72")
  create_vm(config, "sdw3", "sdw3.my.domain", "192.168.56.73")
  create_vm(config, "sdw4", "sdw4.my.domain", "192.168.56.74")
end

